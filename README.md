## 项目介绍

本插件旨在为飞书项目用户提供高效的工作项实例创建方式，通过解析 Excel 文件内容，实现批量创建实例的功能，大幅提升工作效率。

**字段匹配规则**：采用字段名称进行匹配，若存在同名字段则选取第一个；对于复合字段，仅匹配其子字段名称。

> 当前版本已支持文本、富文本、人员类型、选项类型、URL 链接类型、关联工作项、单选按钮、级联类型、复合字段，富文本字段仅支持纯文本内容。

## 环境准备

1. 由于插件存在跨域问题，无法直接访问 openAPI 服务，因此**请提前准备后端代理服务**以保障开发顺利进行。

2. 将步骤 1 中准备的代理服务域名，配置到 `src/constants/index.ts` 文件的 `requestHost` 中。

2. 插件开发的详细操作指南，可参考 [开发者手册](https://project.feishu.cn/b/helpcenter/1p8d7djs/nh4exbsn)。

## 启动项目

1. 打开「飞书项目・开发者后台」中对应的插件详情页。

2. 在左侧导航栏切换至「插件功能」标签页，进行如下配置：

    1. 添加 「新建按钮」 构成并进行下一步配置。
    2. 「工作项类型」 选择 「全部」工作项。
    3. 「适用端」 仅选择 「网页端」。
    4. 「网页端按钮位置」 选择 「新增工作项实例」。
    5. 「网页端 resourceId」修改为 `excel_import`。
    6. 「弹窗最小尺寸」改为「相对宽度」和「相对高度」，且均设置为 `80`。
    7. 确认配置并保存。
    8. 「复制初始化命令」，在本地执行以生成插件工程框架。
    9. 将本项目的 `src` 文件夹替换到生成的工程中。

3. 在左侧导航栏切换至「权限管理」标签页，完善插件权限配置，需勾选以下权限：

    - 勾选 `更新工作项实例数据` 权限
    - 勾选 `获取空间下的基础配置` 权限
    - 勾选 `获取用户信息（跨空间）` 权限
    - 勾选 `获取空间信息（跨空间）` 权限

4. 补充完成插件的基本信息。

5. 在项目目录下运行：`lpm start`。

6. 然后访问「飞书项目·开发者后台」首页，在页面左下角启用插件的本地调试模式。

7. 最后打开「飞书项目」，切换到任意工作项，点击「新建」按钮右侧的分裂按钮，即可预览插件效果。

## 发布你的插件

1. 在终端上运行 `lpm release` 命令来构建产物并上传。

2. 打开「飞书项目·开发者后台」相应插件详情页。

3. 左侧导航切换到「插件发布」tab。

4. 点击「创建版本」填写相关信息，在「产物版本』中选择对应版本产物并提交。

5. 回到「插件发布」页面，会出现一条新增的版本记录，点击该记录的「申请发布」按钮。

6. 恭喜，你现在已经成功发布了一个插件，可以回到「飞书项目」插件市场去安装并尽情使用啦！
